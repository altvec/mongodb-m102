# CRUD and administrative commands

## Inserting documents

Create database:

```
> user create_lesson_db
switched to db create_lesson_db
```

View current database in use:

```
> db
create_lesson_db
```

Show collections:

```
> show collections
```

Inserting an object:

```
> db.sample.insert({a:1})
```

Show collections again. Now we can see a new collection - 'sample':

```
> show collections
sample
system.indexes
```

Find all documents in the 'sample' collection:

```
> db.sample.find()
{ "_id" : ObjectID("535a9a9033352f009db551bfd"), "a" : 1 }
```

ObjectID is generated by mongodb driver, but you can specify it youself.


## Updating documents

You can update one or more documents at a time. Syntax for the update command is something like the following: `db.<collectionName>.update(<where>, <document_or_partial, update_expression>, <upsert>, <multi>)`.

`<multi>` - update multiple documents
`<upsert>` - update document or insert if not present

There are two types of update:
- Full document update/replacement
- partial update (changing only one field)

Let's assume that we have a collection `test` in `pcat` database.

```
> db
pcat

> t.find()
{ "_id" : ObjectID("535a9a9033352f009db551bf3"), "x" : "hello" }
{ "_id" : ObjectID("535a9a9033352f009db551bf2"), "x" : "hello" }
{ "_id" : ObjectID("535a9a9033352f009db551bf1"), "x" : "hello" }
{ "_id" : 100, "x" : "hello" }
{ "_id" : 101, "x" : "hello" }
```

Let's update document with id = 100:
```
> t.update( { '_id' : 100 }, { '_id' : 100, x : "hello world", y : 123 })
WriteResult( {"nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })
```

**Remember: you can not change object Id!**

`_id` field must exist in every document, must be unique inside the collection and is automatically indexed by the MongoDB.


### Partial updates

Suppose we have a collection, 'cars', with one document preexisting:
`{ "_id" : 100, "name" : "GTO", "year" : 1969, "color" : "red" }`

and we want to update it by adding field `available : 1`.

This is how to do it:
```
db.cars.update( {_id:100}, {$set:{available:1}} )
```

The query part, `{_id:100}` identifies the document we want to update, and the ipdate part, `{$set:{available:1}}` sets the "available" field to 1.


